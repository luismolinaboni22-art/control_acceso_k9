<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Sitios - Corporación K9</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<header>
    <img src="{{ url_for('static', filename='images/logo.jpeg') }}" alt="Logo K9" class="logo">
    <h1>Corporación K9</h1>
    <nav>
        <span>{{ current_user.name }}</span>
        <a href="{{ url_for('logout') }}">Cerrar sesión</a>
    </nav>
</header>

<main>
    <h2 class="fw-bold mb-4">Administración de Sitios</h2>

    <!-- Mensajes flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="flash-message {{ category }}">{{ message }}</div>
        {% endfor %}
    {% endif %}
    {% endwith %}

    <!-- Botón para agregar sitio nuevo -->
    <a href="{{ url_for('admin_sites_new') }}" class="btn btn-success mb-3">
        Agregar Sitio
    </a>

    <!-- Tabla de sitios -->
    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>Nombre del Sitio</th>
                <th>Ubicación</th>
                <th>Estado</th>
                <th class="text-center">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for site in sites %}
            <tr>
                <td>{{ site.nombre }}</td>
                <td>{{ site.ubicacion }}</td>
                <td>
                    {% if site.activo %}
                        <span class="badge bg-success">Activo</span>
                    {% else %}
                        <span class="badge bg-danger">Inactivo</span>
                    {% endif %}
                </td>
                <td class="text-center">
                    <!-- EDITAR -->
                    <a href="{{ url_for('admin_sites_edit', site_id=site.id) }}" class="btn btn-primary btn-sm">
                        Editar
                    </a>

                    <!-- ACTIVAR / DESACTIVAR -->
                    <form action="{{ url_for('admin_sites_toggle', site_id=site.id) }}" method="POST" style="display:inline-block;">
                        <button class="btn btn-warning btn-sm">
                            {% if site.activo %}Desactivar{% else %}Activar{% endif %}
                        </button>
                    </form>

                    <!-- ELIMINAR -->
                    <form action="{{ url_for('admin_sites_delete', site_id=site.id) }}" method="POST" style="display:inline-block;" onsubmit="return confirm('¿Seguro que deseas eliminar este sitio?')">
                        <button class="btn btn-danger btn-sm">Eliminar</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</main>
</body>
</html>
